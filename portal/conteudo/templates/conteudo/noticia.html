{% extends 'core/detalhe.html' %}
{% load thumbnail %}

{% block stylesheet %}
    {{ block.super }}
    <link rel="stylesheet" href="{{ STATIC_URL }}css/blueimp-gallery.min.css">
{% endblock %}

{% block breadcrumbs %}
    <li><a href="{% url 'conteudo:noticias_lista' %}">Notícias</a></li>
    <li class="current"><a href="#">{{ noticia.titulo|truncatewords:"3" }}</a></li>
{% endblock %}

{% block edicao %}
    {% if user.is_authenticated %}
        <div class="row padding-top">
            <div class="medium-12 columns text-right">
                <a href="{% url 'admin:conteudo_noticia_change' noticia.id %}" target="_blank">
                    <i class="fi-page-edit"></i> Editar notícia
                </a>
            </div>
        </div>
    {% endif %}
{% endblock edicao %}

{% block conteudo %}
    <div class="row padding-bottom">
    <div class="row">
        {% if not noticia.publicar %}
            <div class="row"><h2 class="vermelho padding-top-bottom text-center">NÃO PUBLICADO</h2></div>
        {% endif %}
        <h1 class="justificado" id="titulo">{{ noticia.titulo }}</h1>

        <p class="padding-top-bottom">{{ noticia.data_publicacao }}</p>
    </div>
    <div class="row">
        {% if noticia.imagens %}
            <div class="medium-10 columns no-padding">
        {% else %}
            <div class="medium-12 columns no-padding">
        {% endif %}

        {% autoescape off %}
            <article>
                {{ noticia.texto|safe }}
            </article>
        {% endautoescape %}

        </div>
        {% if noticia.imagens %}
            <div class="medium-2 columns">
                <div class="row">
                    <ul class="clearing-thumbs small-block-grid-3 medium-block-grid-1" id="links">
                        {% for imagem in noticia.imagens %}
                            <li>
                                <a class="th" href="{% thumbnail imagem.arquivo 1000x800 upscale quality=80 %}"
                                   title="{{ imagem.descricao }}">
                                    <img src="{% thumbnail imagem.arquivo 200x200 crop quality=80 %}"
                                         alt="{{ imagem.descricao }}">
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        </div>
    </div>

    {% if noticia.tags.all %}
        <div class="row collapse padding-bottom-duplo">
            <div class="small-12 columns">
                <ul class="sem-marcador no-margin">
                    <li class="padding-right">Tags:</li>
                    {% for tag in noticia.tags.all %}
                        <li class="padding-all fundo-cinza"><a
                                href="{% url 'conteudo:tags_lista' slug=tag.slug %}">{{ tag.slug }}</a></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    {% endif %}

    <div class="row">
        <div class="medium-4 columns">
            {% if noticia.documentos %}
                <h2 class="fundo-vermelho padding-top-bottom text-center">Arquivos relacionados</h2>
                {% for documento in noticia.documentos %}
                    <div class="row padding-bottom">
                        <a href="{{ documento.arquivo.url }}" target="_blank"><i
                                class="fi-download texto-tamanho-medio alinhamento-vertical">
                        </i>{{ documento.descricao }}
                        </a>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <div class="medium-4 columns">
            {% if noticia.galerias.all %}
                <h2 class="fundo-vermelho padding-top-bottom text-center">Galerias relacionados</h2>
                {% for galeria in noticia.galerias.all %}
                    <div class="row padding-bottom">
                        <a href="{{ galeria.get_absolute_url }}" target="_blank"><i
                                class="fi-photo texto-tamanho-medio alinhamento-vertical">
                        </i>{{ galeria.titulo }}
                        </a>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <div class="medium-4 columns">
            {% if noticia.videos.all %}
                <h2 class="fundo-vermelho padding-top-bottom text-center">Vídeos relacionados</h2>
                {% for video in noticia.videos.all %}
                    <div class="row padding-bottom">
                        <a href="{{ video.get_absolute_url }}" target="_blank"><i
                                class="fi-play-video texto-tamanho-medio alinhamento-vertical">
                        </i>{{ video.titulo }}
                        </a>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>

    <!-- The Gallery as lightbox dialog, should be a child element of the document body -->
    <div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls">
        <div class="slides"></div>
        <h3 class="title"></h3>
        <a class="prev">‹</a>
        <a class="next">›</a>
        <a class="close">×</a>
        <a class="play-pause"></a>
        <ol class="indicator"></ol>
    </div>

{% endblock conteudo %}

{% block javascript %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}js/blueimp-gallery.min.js"></script>

    <script>
        document.getElementById('links').onclick = function (event) {
            event = event || window.event;
            var target = event.target || event.srcElement,
                    link = target.src ? target.parentNode : target,
                    options = {index: link, event: event},
                    links = this.getElementsByTagName('a');
            blueimp.Gallery(links, options);
        };
    </script>
{% endblock %}